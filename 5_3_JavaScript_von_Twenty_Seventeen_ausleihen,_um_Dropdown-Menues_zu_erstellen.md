# JavaScript von Twenty Seventeen "ausleihen", um Dropdown-Menüs zu erstellen

Im Moment sieht meine Speisekarte gut aus, aber sie funktioniert nicht richtig. Ich habe keine Möglichkeit, zu den Dropdown-Elementen für diese beiden Buttons mit Dropdown-Elementen zu gelangen. Und wenn ich die Breite des Bildschirms verkleinere, bekomme ich einen Knopf, der das Menü öffnen soll, aber wenn du darauf klickst, passiert nichts. Das liegt daran, dass das neue Stylesheet nicht mit dem JavaScript übereinstimmt, das dieses Zeug handhaben soll. Das ist das JavaScript, das mit Unterstrichen geliefert wurde. Und das ist auch in Ordnung, denn ich möchte kein JavaScript aus Unterstrichen verwenden. Ich möchte die Lösung nutzen, die 2017 zur Verfügung steht. Es ist viel raffinierter und es ist auch besser für Touch-Geräte und für Leute, die mit der Tastatur navigieren.

In einem separaten Tab habe ich meine Seite geöffnet und ich sehe sie mit dem 17. Im Customizer sehen Sie, dass der Customizer hier auf der linken Seite versteckt ist. In 172, wenn ein Menüpunkt eine Dropdown-Liste hat, erscheint neben ihm dieses Chevron; es ist eigentlich eine Schaltfläche, und wenn Sie auf die Schaltfläche klicken, zeigen Sie die Dropdown-Liste an. Klicken Sie irgendwo, und die Dropdown-Liste verschwindet. Auf diese Weise kann jemand, der auf die Website zugreift und ein Touch-Gerät verwendet, das Dropdown-Menü öffnen, ohne dass er irgendwelche Schwebebewegungen oder andere Aktionen ausführen muss. Dieses ist, was ich auf meinem Aufstellungsort wünsche.

Und bevor wir etwas tun, lassen Sie mich Ihnen kurz zeigen, wie Unterstreichungen Griffe Drop-Downs und alles aus der Box. Wenn wir functions. php durchgehen und zum Script-Setup scrollen, ist es hier unten, werden Sie sehen, dass wir etwas in die Warteschlange stellen, das humescores-Navigation genannt wird. Dies zeigt auf den Ordner js und naviagtion. js. Gehen Sie zu js, und Navigation. js, und Sie werden sehen, hier haben wir einige rudimentäre JavaScript, das die Dropdown-Funktionen erstellt und fügt auch einige Zugänglichkeit. Hier steht sogar:"Umschalten des Navigationsmenüs für kleine Bildschirme und TAB-Tasten-Navigation für Dropdown-Menüs. Das funktioniert gut, aber ich möchte etwas Raffinierteres und Fortschrittlicheres.

Also werde ich das mit dem ersetzen, was in 21 ist. Werfen wir also einen Blick auf 2017 und wie die Dinge aufgebaut sind. Ich gehe in functions. php für twentyseventeen und scrollen Sie unten zu ungefähr Zeile 370-ish. Ja, hier; wir haben die 171-zwanzig Skripte Sektion und innerhalb von 17-zehn Skripten, wenn wir ein wenig nach unten scrollen, finden wir 17-zehn-Navigation. Hier zeigen wir einen Ordner namens Assets und js, und dann Navigation. js. Und es gibt auch ein paar Sachen hier unten, die besagen:"Expand child menu" und "Collapse child menu", die mit dieser Navigation zusammenhängen.

Und wir werden uns gleich darum kümmern. Aber jetzt lasst uns erst mal zu den Assets gehen, dann js, such dir Navigation. js. Hier werde ich einfach alles markieren, kopieren und Navigation. js schließen, zu mythemenavigation. js gehen, alles markieren und löschen, und dann den Code aus zwanzigzehn einfügen. Jedes Mal, wenn ich nun Inhalte von einem Thema in ein anderes Thema kopiere, mache ich immer zuerst eine Suche und ersetze sie. Also gehe ich zu Kontrolle H, und dann suche ich nach 21:17; hier gibt es 15 Matches und ich werde sie alle gegen Humescores eintauschen, wie mein Thema Replace All heißt.

Und dann kann ich diese Datei speichern, zum Browser zurückkehren, und hier sehen Sie die Menüs immer noch nicht funktionieren und vor allem haben wir eine rote Warnung oben in der Symbolleiste. Dies ist das Debug-Tool, das wir mit den Entwickler-Plugins installiert haben. Wenn Sie darauf klicken und wenn Sie zu JavaScript wechseln, sehen Sie, dass es einen nicht erwünschten Referenzfehler gibt. humescoresScreenReaderText ist nicht definiert. Dies ist nun einer von zwei Fehlern, die gerade auf der Seite ausgelöst werden. Das ist ein Fehler, der andere ist dieses Skript hier ist auf jQuery beruht, wie Sie sehen können, am unteren Ende hier.

Und im Moment sind wir nicht Schlange stehen jQuery in WordPress. Also werde ich das zuerst beheben, indem ich zu functions. php zurückkehre. Hier ist der Aufruf, die humescores-Navigation, und momentan gibt es keine Abhängigkeiten dafür. Also werde ich innerhalb der Abhängigkeit Array hier zu sagen, ich habe eine Abhängigkeit von jQuery. Dies bringt in der Version von jQuery, die Bundles in WordPress. Und es wird in die Warteschlange gestellt und alles wird funktionieren. Aber noch wichtiger ist, dass ich das Problem dieser undefinierten Referenz korrigieren muss. Und wenn ich mir den Code hier anschaue, siehst du ganz genau das, worauf er sagt: global humescoresScreenReaderText.

Im Moment sieht meine Speisekarte gut aus, aber sie funktioniert nicht richtig. Ich habe keine Möglichkeit, zu den Dropdown-Elementen für diese beiden Buttons mit Dropdown-Elementen zu gelangen. Und wenn ich die Breite des Bildschirms verkleinere, bekomme ich einen Knopf, der das Menü öffnen soll, aber wenn du darauf klickst, passiert nichts. Das liegt daran, dass das neue Stylesheet nicht mit dem JavaScript übereinstimmt, das dieses Zeug handhaben soll. Das ist das JavaScript, das mit Unterstrichen geliefert wurde. Und das ist auch in Ordnung, denn ich möchte kein JavaScript aus Unterstrichen verwenden. Ich möchte die Lösung nutzen, die 2017 zur Verfügung steht. Es ist viel raffinierter und es ist auch besser für Touch-Geräte und für Leute, die mit der Tastatur navigieren.

In einem separaten Tab habe ich meine Seite geöffnet und ich sehe sie mit dem 17. Im Customizer sehen Sie, dass der Customizer hier auf der linken Seite versteckt ist. In 172, wenn ein Menüpunkt eine Dropdown-Liste hat, erscheint neben ihm dieses Chevron; es ist eigentlich eine Schaltfläche, und wenn Sie auf die Schaltfläche klicken, zeigen Sie die Dropdown-Liste an. Klicken Sie irgendwo, und die Dropdown-Liste verschwindet. Auf diese Weise kann jemand, der auf die Website zugreift und ein Touch-Gerät verwendet, das Dropdown-Menü öffnen, ohne dass er irgendwelche Schwebebewegungen oder andere Aktionen ausführen muss. Dieses ist, was ich auf meinem Aufstellungsort wünsche.

Und bevor wir etwas tun, lassen Sie mich Ihnen kurz zeigen, wie Unterstreichungen Griffe Drop-Downs und alles aus der Box. Wenn wir functions. php durchgehen und zum Script-Setup scrollen, ist es hier unten, werden Sie sehen, dass wir etwas in die Warteschlange stellen, das humescores-Navigation genannt wird. Dies zeigt auf den Ordner js und naviagtion. js. Gehen Sie zu js, und Navigation. js, und Sie werden sehen, hier haben wir einige rudimentäre JavaScript, das die Dropdown-Funktionen erstellt und fügt auch einige Zugänglichkeit. Hier steht sogar:"Umschalten des Navigationsmenüs für kleine Bildschirme und TAB-Tasten-Navigation für Dropdown-Menüs. Das funktioniert gut, aber ich möchte etwas Raffinierteres und Fortschrittlicheres.

Also werde ich das mit dem ersetzen, was in 21 ist. Werfen wir also einen Blick auf 2017 und wie die Dinge aufgebaut sind. Ich gehe in functions. php für twentyseventeen und scrollen Sie unten zu ungefähr Zeile 370-ish. Ja, hier; wir haben die 171-zwanzig Skripte Sektion und innerhalb von 17-zehn Skripten, wenn wir ein wenig nach unten scrollen, finden wir 17-zehn-Navigation. Hier zeigen wir einen Ordner namens Assets und js, und dann Navigation. js. Und es gibt auch ein paar Sachen hier unten, die besagen:"Expand child menu" und "Collapse child menu", die mit dieser Navigation zusammenhängen.

Und wir werden uns gleich darum kümmern. Aber jetzt lasst uns erst mal zu den Assets gehen, dann js, such dir Navigation. js. Hier werde ich einfach alles markieren, kopieren und Navigation. js schließen, zu mythemenavigation. js gehen, alles markieren und löschen, und dann den Code aus zwanzigzehn einfügen. Jedes Mal, wenn ich nun Inhalte von einem Thema in ein anderes Thema kopiere, mache ich immer zuerst eine Suche und ersetze sie. Also gehe ich zu Kontrolle H, und dann suche ich nach 21:17; hier gibt es 15 Matches und ich werde sie alle gegen Humescores eintauschen, wie mein Thema Replace All heißt.

Und dann kann ich diese Datei speichern, zum Browser zurückkehren, und hier sehen Sie die Menüs immer noch nicht funktionieren und vor allem haben wir eine rote Warnung oben in der Symbolleiste. Dies ist das Debug-Tool, das wir mit den Entwickler-Plugins installiert haben. Wenn Sie darauf klicken und wenn Sie zu JavaScript wechseln, sehen Sie, dass es einen nicht erwünschten Referenzfehler gibt. humescoresScreenReaderText ist nicht definiert. Dies ist nun einer von zwei Fehlern, die gerade auf der Seite ausgelöst werden. Das ist ein Fehler, der andere ist dieses Skript hier ist auf jQuery beruht, wie Sie sehen können, am unteren Ende hier.

Und im Moment sind wir nicht Schlange stehen jQuery in WordPress. Also werde ich das zuerst beheben, indem ich zu functions. php zurückkehre. Hier ist der Aufruf, die humescores-Navigation, und momentan gibt es keine Abhängigkeiten dafür. Also werde ich innerhalb der Abhängigkeit Array hier zu sagen, ich habe eine Abhängigkeit von jQuery. Dies bringt in der Version von jQuery, die Bundles in WordPress. Und es wird in die Warteschlange gestellt und alles wird funktionieren. Aber noch wichtiger ist, dass ich das Problem dieser undefinierten Referenz korrigieren muss. Und wenn ich mir den Code hier anschaue, siehst du ganz genau das, worauf er sagt: global humescoresScreenReaderText.

Und wenn ich mir das Dokument durchsehe, sehen Sie immer wieder, dass ScreenReaderText immer wieder und immer wieder referenziert wird. Also, was ist hier los? Nun, dieser humescoresScreenReaderText ist ein Container, der Textzeichenfolgen enthält, die für Screenreader angezeigt werden. Das bedeutet, dass es der Hilfetext ist, der verwendet wird, wenn jemand mit einem Bildschirmleser auf die Seite zugreift. Und Sie sahen den Hinweis darauf im Code von twentyseventeen, hier unten gerade unter twentyseventeen-Navigation. Ich erwähnte, dass dort steht: "Untermenü erweitern" und "Untermenü komprimieren".

Und Sie können sehen, dass es hier übersetzbar ist. Also werden wir das, was wir hier sehen, in unserem Thema duplizieren. Das bedeutet, dass wir innerhalb des Arrays zwei Werte einstellen. Expandieren Sie zunächst; das entspricht einer übersetzbaren Zeichenkette. Der String lautet:"Untermenü expandieren". Und die Textdomäne ist humescores. Und ich kopiere die Zeile, klebe sie darunter ein. Dies wäre Komprimieren,"Kind-Menü komprimieren". Und das ist alles, was es gibt.

Nun, da wir das Skript lokalisiert haben, und wir die richtige Variable mit den richtigen Informationen an navigation. js übergeben, und wir haben jQuery in die Warteschlange gestellt, sollte alles perfekt im Browser funktionieren. Also speichern Sie functions. php, zurück im Browser. Und jetzt sehen Sie, dass wir hier zwei neue Knöpfe bekommen haben. Neben jedem der Menüpunkte, die Dropdowns haben, haben wir jetzt diese kleinen Dinge in den oberen Ecken. Und wenn Sie darauf klicken, öffnen Sie das Dropdown-Menü. Klicken Sie erneut darauf, schließen Sie die Dropdown-Liste. Außerdem, wenn ich die Breite des Bildschirms verkleinert jetzt, werden Sie sehen, wie wir auf einen Bildschirm, der klein genug, ich kann jetzt klicken Sie auf das primäre Menü, öffnet das Menü.

Klicken Sie auf eine dieser Schaltflächen, öffnet die Untermenüs. Und alles funktioniert einwandfrei. Das heißt nicht, dass wir jetzt fertig sind. Das sieht wackelig aus und wir wissen immer noch nicht genau, was hier vor sich geht, aber zumindest funktioniert es. Das ist der erste Schritt.